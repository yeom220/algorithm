# 도커가 필요한 이유

1. 개발 환경과 운영 환경의 의존성(환경) 문제를 해결
2. 각 팀과 회사마다 다른 개발 환경에서 발생하는 의존성 문제 해결
3. 각 프로젝트마다 다른 툴과 버전에서 발생하는 충돌 문제 해결

---
# 버츄얼 머신의 장단점

### 장점

- 분리(독립)된 환경
- 각각 환경 구성이 가능
- 환경 구성의 안정적인 공유 및 재생산 가능

### 단점

- 새로운 버츄얼 머신을 설치할 때마다 중복 복제로 리소스를 낭비
- 성능이 느려질 수 있음
- 재생산 및 공유가 가능해도 원하는 모든 시스템에 버츄얼 머신을 설정하고 동일한 환경을 구성해야 함
	- **공유할 수 있는 단일 구성 파일 X**

---
# 컨테이너 vs 버츄얼 머신

### 컨테이너
- 컨테이너는 최소한의 OS 구성으로 빠르며, 적은 디스크를 점유한다
- 공유, 재구축, 배포가 간단하다
- **전체 머신(OS) 환경 대신, 앱 및 필요 환경(의존성)만 캡슐화 한다**

### 버츄얼 머신
- 많은 OS 구성요소가 필요하여 속도가 느리며, 많은 디스크를 점유한다
- 공유, 재구축, 배포가 가능하지만 과정이 까다롭다
- **앱 및 필요 환경뿐만 아니라, 전체 머신(OS) 환경을 포함하여 모두 캡슐화 한다**

---
# 도커 Playground

>브라우저에서 도커를 실행해주는 사이트
>https://labs.play-with-docker.com/

---
# 이미지 vs 컨테이너

### 이미지
- 코드와 코드를 실행하는데 필요한 도구(환경)을 패키징한 것
- 모든 설정 명령과 코드가 포함된 공유 가능한 패키지
- 이미지를 기반으로 다른 시스템과 서버에서 여러 번 실행 가능

### 컨테이너
- 이미지의 구체적인 실행 인스턴스
- 실행 애플리케이션

---
# Docker Hub

>Docker 이미지를 저장하고 배포할 수 있는 클라우드 기반 레지스트리 서비스.
>개발 및 배포 프로세스를 단순화하고, 컨테이너화된 애플리케이션을 공유하기 위해 사용된다.

### 주요 기능

1. 이미지 저장소
	- Docker 이미지를 저장, 관리, 배포할 수 있는 중앙 저장소
	- Public 또는 Private 저장소를 제공하며, Public 저장소는 무료
2. 공식 이미지 제공
	- Official 이미지를 제공하여 신뢰할 수 있는 베이스 이미지를 사용 가능
	- 예: `node`, `nginx`, `python` 등...
3. 이미지 검색
	- 다양한 오픈소스 및 커뮤니티 이미지를 검색하여 사용 가능
4. 공유 및 협업
	- 이미지를 공유하거나 다른 개발자가 만든 이미지를 가져다 사용 가능
	- 이미지를 **Push** 하거나 **Pull** 하는 방식으로 관리

---
# Dockerfile

>Dockerfile은 도커 이미지를 생성하기 위한 스크립트 파일로, 이미지 빌드 과정과 컨테이너 환경을 정의.
>Docker는 Dockerfile에 따라 이미지를 빌드하고, 그 결과로 애플리케이션이 실행되는 컨테이너를 생성.

### node 베이스 이미지를 통해 js 실행하는 Dockerfile
```dockerfile
FROM node

WORKDIR /app

COPY . /app

RUN npm install

EXPOSE 80

CMD ["node", "server.js"]
```

- **FROM**
	- 베이스 이미지를 지정
	- Docker 이미지는 기존 이미지 위에 쌓이는 방식으로 빌드되므로 베이스 이미지가 필요
- **WORKDIR**
	- 컨테이너 내부의 작업 디렉터리 설정
- **COPY**
	- 파일/디렉터리를 컨테이너 내부로 복사
- **RUN**
	- 이미지 빌드 과정에서 실행할 명령어
	- 주로 패키지 설치 등의 환경 구성에 사용
- **EXPOSE**
	- 컨테이너에서 외부(호스트)로 노출할 포트 지정
	- **사용할 포트를 나타낼 뿐 실제로 외부와 연결하지는 않음**
- **CMD**
	- 컨테이너 생성시 실행할 명령
	- 단일 명령어만 정의 가능

---
# Dockerfile 기반 커스텀 이미지 및 컨테이너 생성

>Docker 커스텀 이미지 생성

```bash
$ docker build .
```

- **build**
	- Dockerfile을 기반으로 이미지를 생성하는 명령어
	- `.`은 상대 경로로 Dockerfile 위치가 기준

>Docker 컨테이너 생성 및 실행

```bash
$ docker run {Image ID}
```

- **run**
	- 이미지 기반으로 컨테이너를 생성하는 명령어
	- 컨테이너 생성 및 백그라운드 실행
	- `Image ID`의 경우 첫 번째(몇 개) 문자 사용 가능 (고유 식별자를 갖는 경우)

>**위의 명령어 실행시 컨테이너는 생성되지만 접속이 되지 않는다.**
>그 이유는 **컨테이너는 격리된 환경으로 `-p` (publish) 옵션을 통해 외부(호스트)로 노출(연결)해야 한다.**
>호스트(외부) 8080 포트로 위의 컨테이너에 접속하려면 아래와 같이 실행해야 한다.

```shell
$ docker run -p 8080:80 {Image ID}
```

---
# Docker 이미지 특징

### 스냅샷(읽기전용)

>소스코드를 수정 후 컨테이너를 다시 실행해도 변경사항은 적용되지 않는다.
>그 이유는 이미지는 `build` 시점에 `Dockerfile` 에 명시된 대로 소스코드를 컨테이너 내부로 복사하기 때문입니다.
>즉, `build` 이후에 소스를 수정하여도 이미지에 저장된 코드는 변경되지 않기 때문에 적용되지 않습니다.

